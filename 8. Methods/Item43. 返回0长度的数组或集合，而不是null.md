

# Item43. 返回0长度的数组或集合，而不是null



![](https://bucket-1255905387.cos.ap-shanghai.myqcloud.com/2019-01-15-14-24-33_r99.png)



把没有元素的情况当作是一种特例（返回`null`）是不合理的，这样会要求使用者必须有「**额外的代码**」来处理 `null` 返回值。



![](https://bucket-1255905387.cos.ap-shanghai.myqcloud.com/2019-01-15-14-24-46_r67.png)



客户端更好的处理方式应该如下：



![](https://bucket-1255905387.cos.ap-shanghai.myqcloud.com/2019-01-15-14-25-16_r88.png)



## 性能开销问题

程序员很可能忘记处理 `null` 返回值。如果用零长度的数组代替，有人认为可能会有性能开销。



1. 第一是在这个级别上担心性能方面的问题是不明智的（数组分配的开销），除非分析表明这个方法正是造成性能问题的真正源头。

2. 第二是不返回任何元素的调用，**每次都返回同一个零长度的数组是可能的**，因为零长度数组是不可变的，不可能对象有可能被自由地共享（第 15 条）。实际上用标准的做法把一些元素从一个集合转存到一个类型化的数组中时，它正是这样做的（返回同一个零长度数组）。

